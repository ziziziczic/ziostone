<html>
<head>
<title>색상 선택</title>
<style type="text/css">
  body   {margin-left:10; font-family:Verdana; font-size:9pt; background:menu}
  button {width:5em}
  table  {font-family:Verdana; font-size:9pt}
  p      {text-align:right}
</style>
<script language="javascript">
<!--
var array;
var returncolorvalue = "";
var drag;

function init() {
	document.onmouseup = endDrag;
	oldX = oldY = newX = newY = 0;
	drag = null;
}

function getIndex(left, top) {
	var index = ((top/9) * 21) + (left/9);
	return index;
}

function getRGB(index) {
	var array = new Array();
	var retmp, grtmp, bltmp;
	retmp = Math.floor(index/36);
	grtmp = Math.floor((index - (retmp * 36))/6);
	bltmp = Math.floor((index - (retmp * 36) - (grtmp * 6)));
	array["RE"] = retmp * 51;
	array["GR"] = grtmp * 51;
	array["BL"] = bltmp * 51;
	return array;
}

function ChgHE(red, green, blue) {
	var array = new Array();
	red = red - 0;
	green = green - 0;
	blue = blue - 0;
	if(red <16) array["Hre"] = "0" + red.toString(16);
	else array["Hre"] = red.toString(16);
	if(green <16) array["Hgr"] = "0" + green.toString(16);
	else array["Hgr"] = green.toString(16);
	if(blue <16) array["Hbl"] = "0" + blue.toString(16);
	else array["Hbl"] = blue.toString(16);
	array["Hre"] = array["Hre"].toUpperCase();
	array["Hgr"] = array["Hgr"].toUpperCase();
	array["Hbl"] = array["Hbl"].toUpperCase();
	return array;
}

function Viewcolor(red,green,blue) {
	var array = new Array();
	array = ChgHE(red,green,blue);
	viewCol.style.backgroundColor = "#" + array["Hre"] + array["Hgr"] + array["Hbl"];
	return;
}

function Hrgbchange() {
	var array = new Array();
	var abc = "0123456789abcdefABCDEF";
	if(bascolortbl.Hrgb.value.length != 7) return;
	if(bascolortbl.Hrgb.value.substring(0,1) != "#") return;
	for(var i=1; i < 7;i++) {
		if(abc.indexOf(bascolortbl.Hrgb.value.charAt(i)) < 0) return;
	}
	var retmp, grtmp, bltmp;
	retmp = parseInt(bascolortbl.Hrgb.value.substr(1,2),16);
	grtmp = parseInt(bascolortbl.Hrgb.value.substr(3,2),16);
	bltmp = parseInt(bascolortbl.Hrgb.value.substr(5,2),16);
	Viewcolor(retmp, grtmp, bltmp);
	return;
}

function startDrag() {
	var array = new Array();

	if(event.clientX < 3 || event.clientX > 191) return;
	if(event.clientY < 3 || event.clientY > 107) return;
	drag = bascolortbl.cursor;
	var Left = 9 * Math.floor((event.clientX - 3)/9);
	var Top = 9 * Math.floor((event.clientY - 3)/9);
	if(Top > 81) {
		Top = 90;
		if(Left > 45) return;
	}
	drag.style.pixelLeft = Left;
	drag.style.pixelTop = Top;
	var index = getIndex(Left,Top);
	array = getRGB(index);
	Viewcolor(array["RE"], array["GR"], array["BL"]);
	array = ChgHE(array["RE"], array["GR"], array["BL"]);
	bascolortbl.Hrgb.value = "#" + array["Hre"] + array["Hgr"] + array["Hbl"];
	return;
}

function dragIt() {
	var array = new Array();
	if(drag != bascolortbl.cursor) return;
	if(event.clientX < 3 || event.clientX > 191) {
	} else if(event.clientY < 3 || event.clientY > 106) {
	} else {
		var Left = 9 * Math.floor((event.clientX - 3)/9);
		var Top = 9 * Math.floor((event.clientY - 3)/9);
		if(Top > 81) {
			Top = 90;
			if(Left > 45) {
				return;
			}
		}
		drag.style.pixelLeft = Left;
		drag.style.pixelTop = Top;
		var index = getIndex(Left,Top);
		array = getRGB(index);

		Viewcolor(array["RE"], array["GR"], array["BL"]);
		array = ChgHE(array["RE"], array["GR"], array["BL"]);
		bascolortbl.Hrgb.value = "#" + array["Hre"] + array["Hgr"] + array["Hbl"];
	}
	event.returnValue = false;
}

function endDrag() {
	drag = null;
	return;
}

function selectok() {
	returncolorvalue = bascolortbl.Hrgb.value;
	window.returnValue = returncolorvalue;
	window.close();
}

function CallPal(e) {
	var x = e.screenX - event.clientX;
	var y = e.screenY - event.clientY;
	x = x;
	y = y;
	returncolorvalue = showModalDialog("../js/pal.nwz",bascolortbl.Hrgb.value,"font-family:Verdana; font-size:12; dialogHeight:310px; dialogWidth:480px; dialogLeft:" + x + "px; dialogTop:" + y + "; status:no; help:no; scroll:no");
	window.returnValue = returncolorvalue;
	window.close();
}

function selectcancel() {
	window.close();
}

-->
</script>
</head>

<body onload="init()">

<form id=bascolortbl name=bascolortbl>
<div id=wholelayer style="visibility:visible; background-image:url('../js/image/color216.gif'); position:absolute; left:0; top:0; width:196; height:137; z-index:12">
  <div id=viewCol style="background-color:#000000;position:absolute; width:38; height:20; top:116; left:4; z-index:1" onclick="selectok()">
  </div>
  <div style="position:absolute; top:114; left:45; z-index:2">
    <input id=Hrgb type=text style="width:70; height:22" value="#cccccc" onkeyup="Hrgbchange()">
    &nbsp;
    <button id=apply type=button style="width:36; height:22" value="확인" onclick="selectok()">선택</button>
     <button id=callpal type=button style="width:36; height:22" value="기타" onclick="CallPal(event)">기타</button>
  </div>
  <div id=BasicCol style="position:absolute; width:190; height:100; top:3; left:3; z-index:3" onmousemove="javascript:dragIt()" onmousedown="startDrag()">
    <img id=cursor src="../js/image/picker3.gif" border=0 style="position:absolute; top:0; left:0; width:10; height:10">
  </div>
</div>

<table>
</table>
</form>
</body>
</html>
